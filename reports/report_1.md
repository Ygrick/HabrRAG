# Отчёт по подготовке данных для проекта HabrIQ

## 1. Процесс получения данных

В проекте используется два источника данных.

**Основной датасет** был загружен с открытой платформы HuggingFace (датасет предоставлен Ильёй Гусевым). Для работы с ним применялся стандартный метод загрузки датасетов через библиотеку `datasets`. В случаях, когда этот метод недоступен в новых версиях, можно использовать альтернативный подход: скачать данные в формате `jsonl` и обрабатывать их вручную.

**Синтетический датасет** был создан командой проекта на основе датасета статей Habr. Данный датасет формировался для оценки качества работы RAG-системы.

## 2. Структура данных и хранение

### 2.1. Основной датасет (Habr)

Исходные данные имеют следующую структуру:

```json
{
  "id": 12730,
  "language": "ru",
  "url": "https://habr.com/ru/post/12730/",
  "text_markdown": "# Основной заголовок\n\nЭто текст статьи в формате markdown. Здесь может быть код, списки и другие элементы разметки...",
  "text_html": "<h1>Основной заголовок</h1><p>Это текст статьи в формате HTML...</p>",
  "lead_markdown": "Краткое введение к статье в формате markdown...",
  "lead_html": "<p>Краткое введение к статье в формате HTML...</p>",
  "type": "article",
  "labels": ["перевод", "научпоп"],
  "original_author": "John Doe",
  "original_url": "https://example.com/original-article",
  "time_published": 1185962380,
  "author": "Иван Иванов",
  "title": "Хочешь в университет — сделай презентацию",
  "statistics": {...},
  "hubs": ["itcompanies"],
  "flows": ["popsci"],
  "tags": ["PowerPoint", "презентация", "абитуриенты"],
  "reading_time": 5,
  "format": "longread",
  "complexity": "medium",
  "comments": {...}
}
```

Для проекта был отобран поднабор из **1000 статей** из общего объёма в ~76 000.

**Хранение:** Данные хранятся в векторной базе данных Quadrant. Перед загрузкой текст статьи (поле `text_markdown`) разбивается на части (чанки) размером примерно по 1000 символов. Каждый чанк, помимо текста, снабжается метаданными:

- `id` — идентификатор исходной статьи.
- `author` — автор статьи.
- `url` — прямая ссылка на статью.
- `title` — заголовок статьи.
- `document_id` — порядковый номер чанка внутри статьи.
- `chunk_id` — глобальный уникальный идентификатор чанка в базе.

### 2.2. Синтетический датасет

Этот набор данных был сгенерирован с помощью LLM на основе чанков основного датасета. Для каждого текстового фрагмента модель формировала релевантный вопрос и ответ на него, используя только информацию из этого чанка.

Структура итогового датасета:

```json
{
  "id": 12730,
  "author": "Юлия Благовещенская (skazala)",
  "url": "https://habr.com/ru/post/12730/",
  "title": "Хочешь в университет — сделай презентацию",
  "document_chunk_id": 0,
  "global_chunk_id": 0,
  "question": "Сколько презентаций PowerPoint, по оценкам Microsoft, демонстрируется в мире ежедневно?",
  "answer": "По оценкам Microsoft, ежедневно в мире показывается порядка 30 миллионов презентаций PowerPoint."
}
```

Объём синтетического датасета составляет **~500 пар "вопрос-ответ"**. Данные хранятся в файле формата `jsonl`.

## 3. Подготовка данных для RAG/LLM/агента

Подготовка данных выполнена в полном объёме и включает два ключевых этапа.

**Чанкирование (chunking).** Тексты всех статей основного датасета были чанкованы на последовательные фрагменты фиксированного размера. Это необходимо для эффективного сопоставления запроса пользователя с релевантными частями документов.

**Первичная структуризация.** Оба набора данных приведены к готовому для использования виду:

1.  Основные данные чанкированы, наполнены метаданными и загружены в векторное хранилище (Quadrant), что позволяет производить по ним семантический поиск.
2.  Синтетический датасет сгенерирован и сохранён. Каждая его запись содержит пару «вопрос–ответ» и полную метаинформацию о текстовом фрагменте (чанке), на основе которого эта пара была сгенерирована.

## 4. Ссылка на сэмпл данных

Ниже представлен снимок Quadrant хранилища с чанкованными данными статей для дальнейшей работы RAG системы. Сам датасет расположен по ссылке:
[IlyaGusev/habr](https://huggingface.co/datasets/IlyaGusev/habr)

Кроме того, примеры подготовленных данных - синтетического датасета (образцы чанков основного синтетических пар "вопрос-ответ") доступны по ссылке: [датасет в формате jsonl](https://drive.google.com/file/d/1o8rNEoPc9dkswgwfSU3UCxXz1brAgYHx/view?usp=sharing)
